{% load static %}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>Join Chat Room</title>
    <link rel="stylesheet" href="{% static 'chat/style.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="container">
        <div class="card">
            <h1>Welcome to Chat</h1>
            <p style="color: var(--text-muted); margin-bottom: 1.5rem;">Enter your details to join</p>

            <input id="username-input" type="text" placeholder="Your Name" autocomplete="off">
            <input id="room-name-input" type="text" placeholder="Room Name (e.g. lobby)" autocomplete="off">

            <input id="room-name-submit" type="button" value="Join Room">
        </div>
    </div>

    <script>
        const roomInput = document.querySelector('#room-name-input');
        const usernameInput = document.querySelector('#username-input');
        const submitBtn = document.querySelector('#room-name-submit');

        usernameInput.focus();

        function handleEnter(e) {
            if (e.keyCode === 13) {
                submitBtn.click();
            }
        }

        roomInput.onkeyup = handleEnter;
        usernameInput.onkeyup = handleEnter;

        submitBtn.onclick = function(e) {
            var roomName = roomInput.value.trim();
            var username = usernameInput.value.trim();

            if (username === "") {
                alert("Please enter your name.");
                return;
            }
            if (roomName === "") {
                alert("Please enter a room name.");
                return;
            }
            if (!/^[a-zA-Z0-9_-]+$/.test(roomName)) {
                alert("Room name can only contain letters, numbers, hyphens, and underscores.");
                return;
            }

            window.location.href = '/chat/' + roomName + '/?username=' + encodeURIComponent(username);
        };
    </script>
</body>

</html>